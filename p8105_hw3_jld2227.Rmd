---
title: "HW3"
author: "James Dalgleish"
date: "October 9, 2018"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(knitr)
```
First, we'll begin by importing the dataset, cleaning the names to be more appropriate, and
focusing on the Overall Health topic (by filtering for this topic only in the BRFSS responses).
Responses are filtered to only include the 5 ordinal categories, Excellent, Very Good,
Good, Fair, Poor.
```{r data_import}
brfss <- p8105.datasets::brfss_smart2010 %>% #Pulls dataframe out of package.
  janitor::clean_names() %>%  #Converts to snake case.
  filter(topic == "Overall Health",
         response %in% c("Excellent","Very Good", "Good", "Fair", "Poor")) %>%     #Filters by overall health topic.
  mutate(response = factor(response,levels = c("Excellent","Very Good", "Good", "Fair", "Poor")))
  
  
```
Problem 2
```{r instacart_import}
instacart <- p8105.datasets::instacart %>% #Pulls dataframe out of package.
  janitor::clean_names() #cleans names
```
```{r distinct_aisles}
distinct_aisles <- instacart %>%
  group_by(aisle) %>% 
  summarize(count = n()) %>% 
  arrange(
    desc(count)
  )

distinct_aisles %>% kable()
```
There appear to be `r nrow(distinct_aisles)` aisles. The aisles with the most are displayed in the
table below:
```{r}
distinct_aisles %>% 
  head() %>% 
  kable()
```

The numbers of items in each aisle can be visualized with the following plot:

```{r}
items_by_aisle <- instacart %>%
  group_by(aisle) %>% 
count() %>% 
  arrange(
    desc(n)
    ) %>%
as.data.frame() %>% #makes the grouping variable modifyable 
  as.tibble() %>%  #factor reorder.
  mutate(aisle = forcats::fct_reorder(aisle, n))


items_by_aisle %>% 
  ggplot(aes(x = aisle,y = n,color = n)) +
  geom_col() +
  scale_color_viridis_c() +
  theme_bw() +
  theme(axis.title.x = element_blank(),
        axis.text.x = element_blank(),
        axis.ticks.x = element_blank(),
        panel.grid.major = element_blank(),
        panel.grid.major = element_blank()) + 
  ylab("Items in aisle")
```


